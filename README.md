# [김영한님] 실전! Querydsl
기존에 JPQL을 직접 작성하여 쿼리를 작성하는 방식에서 Querydsl을 적용하여 자바 기반으로 쿼리를 요청하는 방법을 살펴본다. JPQL을 문자로 작성하던 방식은 실행 시점에서 오류를 알 수 있지만 Querydsl은 자바 코드이기 때문에 컴파일 시점에서 오류를 알 수 있다. 또한 JPQL은 파라미터 바인딩을  직접 처리해야 했지만 Querydsl은 자동으로 처리해준다.

## 배운점
- 기본적인 문법(조건절, 조인, 페이징, 정렬)

- from 절의 서브쿼리 해결방안<br/>
JPA JPQL의 서브쿼리의 한계점으로 현재는 from 절의 서브쿼리는 지원하지 않는다. 해결방안으로는 가능하다면 서브쿼리를 join으로 
변경하거나, 쿼리를 2번 분리해서 실행, nativeSQL을 사용하는 방법이 있다.

- 다양한 프로젝션 결과 반환<br/>
튜플이 하나일 때는 반환 타입을 명확하게 지정할 수 있고, 둘 이상일 때는 Tuple 타입으로 반환된다. DTO로 조회시에는 property 접근, field 접근, constructor 접근, 3가지 방식을 지원한다. 이 방식 중 constructor 접근 방식이 컴파일러로 타입을 체크할 수 있는 가장 안전한 방법이지만 DTO의 생성자에 추가로 어노테이션을 선언해야 하고 DTO 까지 Q 파일을 생성해야하는 단점이 있다.

- where 절 동적 쿼리 작성<br/>
동적 쿼리 작성 시 BooleanBuilder 보다는 BooleanExpression 반환 타입의 메서드를 별도로 만들어서 사용하는 것이 가독성이 좋고 조건절을 재활용할 수 있다.

- 페이징 조회 시 count 쿼리 최적화 방법<br/>
페이징을 사용하여 조회 시 fetchResults() 로 결과 값을 받으면 count 쿼리가 자동으로 실행된다. count 쿼리를 별도로 작성하기 위해서는 결과 값을 fetch() 로 받고, 별도의 count 쿼리를 작성하여 fetchCount()로 받으면 된다. (Querydsl 5.0 부터는 Deprecated 됨.)
